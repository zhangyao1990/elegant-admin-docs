---
title: 页面缓存
date: 2023-07-12 14:43:58
permalink: /pages/9be742/
article: false
---
首先不管路由配置多少嵌套层级，最终都会被处理成两级结构。其原因是因为三级及以上路由在处理页面缓存上，总有各式各样的问题。

那么在两级路由下，我们要如何实现页面缓存，请继续往下看。

::: warning 注意⚠️
开启缓存必须保证每个页面组件必须设置 name ，并且确保 name 唯一。
:::
## 使用
我们只需要在需要进行缓存的路由 meta 对象里配置 cache 参数即可。这个参数可接受以下 3 种类型：

* `boolean`
* `string`
* `array`

当设置为 true 时，该页面只要一被访问，就会被缓存。例如有一个模块，我们列表页设置为 `cache: true` 后并访问，然后点击某条记录进入详情页，这时候再从详情页返回列表页时，列表页上的数据是不会重新加载，而是保留了当时离开时的状态。

但这个方案也有一个弊端，就是该页面一旦访问就永久被缓存住了（需要手动刷新或点击框架提供的刷新按钮），如果用户从列表页进入的不是详情页，而是其它模块的页面，这时候其实是不希望列表页被缓存的。这种情况下，可以设置 `string` 和 `array` 两个类型的参数值。

不管设置 `string` 还是 `array` ，你需要设置的值，都是路由的 `name` 。

```js
const routes: Route.recordRaw = {
  path: '/news',
  children: [
    {
      path: 'list',
      name: 'NewsList',
      meta: {
        title: '列表',
        cache: 'NewsDetail',
      },
    },
    {
      path: 'detail/:id',
      name: 'NewsDetail',
      meta: {
        title: '详情',
        sidebar: false,
        activeMenu: '/news/list',
      },
    },
  ],
}
```
这表示从列表页进入详情页时，列表页才会被缓存，进入其它任何页面都不会缓存。

也可将 `cache` 设置成 `name` 数组。

```js
const routes: Route.recordRaw = {
  path: '/news',
  children: [
    {
      path: 'list',
      name: 'NewsList',
      meta: {
        title: '列表',
        cache: ['NewsDetail', 'NewsCreate'],
      },
    },
    {
      path: 'detail/:id',
      name: 'NewsDetail',
      meta: {
        title: '详情',
        sidebar: false,
        activeMenu: '/news/list',
      },
    },
    {
      path: 'create',
      name: 'NewsCreate',
      meta: {
        title: '其他二级页面',
        sidebar: false,
        activeMenu: '/news/list',
      },
    },
  ],
}
```
这样就表示从列表页进入详情页或其他二级页面时，列表页才会被缓存，进入其它任何页面都不会缓存。
